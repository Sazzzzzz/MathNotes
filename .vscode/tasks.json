{
    "version": "2.0.0",
    "tasks": [
        {
            "label": "Convert Image to PDF",
            "type": "shell",
            "command": "magick \"${file}\" \"${fileDirname}/${fileBasenameNoExtension}.pdf\"",
            "problemMatcher": [],
            "presentation": {
                "reveal": "silent",
                "panel": "shared",
                "close": true
            }
        },
        {
            "label": "Convert PDF to PNG Image",
            "type": "shell",
            "command": "magick -density 300 \"${file}\" -quality 100 \"${fileDirname}/${fileBasenameNoExtension}.png\"",
            "problemMatcher": [],
            "presentation": {
                "reveal": "silent",
                "panel": "shared",
                "close": true
            }
        },
        {
            "label": "Convert Math Delimiters from dollar to LaTeX",
            "type": "shell",
            "description": "Convert LaTeX math delimiters $ and $$ to \\( \\) and \\[ \\] respectively using regex. Other occurrences of double dollar sign are not allowed.",
            "command": "python3 -c 'import re; content = open(\"${file}\", \"r\").read(); content = re.sub(r\"\\$\\$(.+?)\\$\\$\", r\"\\\\[\\1\\\\]\", content, flags=re.MULTILINE | re.DOTALL | re.UNICODE);  content = re.sub(r\"\\$(.+?)\\$\", r\"\\\\(\\1\\\\)\", content, flags=re.MULTILINE | re.DOTALL | re.UNICODE); open(\"${file}\", \"w\").write(content)'",
            "presentation": {
                "reveal": "silent",
                "panel": "shared",
                "focus": false,
                "clear": false,
                "echo": false,
                "showReuseMessage": false
            },
            "problemMatcher": []
        },
        {
            "label": "Convert Math Delimiters from LaTeX to Dollar",
            "type": "shell",
            "description": "Convert LaTeX math delimiters \\( \\) and \\[ \\] to $ and $$ respectively using regex. Other occurrences of \\(\\) and \\[\\] are not allowed.",
            "command": "python3 -c 'import re; content = open(\"${file}\", \"r\").read(); content = re.sub(r\"(\\\\\\()|(\\\\\\))\", r\"$\", content, flags=re.UNICODE); content = re.sub(r\"(\\\\\\[)|(\\\\\\])\", r\"$$\", content, flags=re.UNICODE); open(\"${file}\", \"w\").write(content)'",
            "presentation": {
                "reveal": "silent",
                "panel": "shared",
                "focus": false,
                "clear": false,
                "echo": false,
                "showReuseMessage": false
            },
            "problemMatcher": []
        },
        {
            "label": "Extract PDF Pages",
            "type": "shell",
            "description": "Extract pages from a PDF file using Ghostscript. Modify startPage and endPage in args.",
            "command": "gs",
            "args": [
                // gs looks like ancient tool ...
                "-sDEVICE=pdfwrite",
                "-dNOPAUSE",
                "-dBATCH",
                "-dSAFER",
                "-dFirstPage=${input:startPage}",
                "-dLastPage=${input:endPage}",
                "-sOutputFile=${fileDirname}/${fileBasenameNoExtension}_pp.${input:startPage}-${input:endPage}.pdf",
                "${file}"
            ],
            "problemMatcher": [],
            "presentation": {
                "reveal": "silent",
                "panel": "shared",
                "focus": false,
                "clear": false,
                "echo": false,
                "showReuseMessage": false
            }
        },
        {
            "label": "Extract PDF Pages to PNG",
            "type": "shell",
            "description": "Extract pages from a PDF file using Ghostscript. Then convert to a long png image using ImageMagick. Modify startPage and endPage in args.",
            "dependsOn": "Extract PDF Pages",
            "command": "magick",
            "args": [
                "${fileDirname}/${fileBasenameNoExtension}_pp.${input:startPage}-${input:endPage}.pdf",
                "-density",
                "300",
                "-quality",
                "150",
                "-append",
                "${fileDirname}/${fileBasenameNoExtension}_pp.${input:startPage}-${input:endPage}.png"
            ],
            "problemMatcher": [],
            "presentation": {
                "reveal": "silent",
                "panel": "shared",
                "focus": false,
                "clear": false,
                "echo": false,
                "showReuseMessage": false
            }
        }
    ],
    "inputs": [
        {
            "id": "startPage",
            "type": "promptString",
            "description": "Enter the start page number:",
            "default": "1"
        },
        {
            "id": "endPage",
            "type": "promptString",
            "description": "Enter the end page number:",
            "default": "1"
        }
    ]
}